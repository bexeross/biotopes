---
title: "Vulnerable habitats"
output: html_notebook
---

Trying a new approach in order to align VME models with generic biotope models better. Inputs required: the classified samples, as well as the species matrix and the environmental matrix.

## Libraries
```{r}
library(readxl)
library(dplyr)
```

### New approach
VME presence/absence or quality is dervied from the classified samples, which in turn is largely based on the twinspan classification with some manual tweaks.

## Build a response variable
```{r}
vme="pB8" # so far this is a mockup suing provisional biotopes!
resp <- sheet1 %>%
  mutate(vme = case_when(Biotope_class=vme))
```

### Old approach
VMEness is determined from abundances of VME indicators
## Read data
```{r}
# species densities (trimmed)
in.data.vh <- read.csv(file.path(outPath,"species_densities_trimmed.csv"))

# habitat definitions with list of qualifying taxa
habdef <- read_xlsx(file.path(dataPath,"HabitatDefinitions.xlsx"))
```


## select habitat of interest
```{r}
hab <- data.frame(number = c(1:9), name = unique(habdef$VH))
hab
```

## Create dummy variable and populate
```{r}
h <- 2
in.data.vh <- in.data.vh %>%
  mutate(vh_dummy = case_when(new_name%in%pull(subset(habdef,habdef$VH==hab$name[h],2))~1))
  
```
