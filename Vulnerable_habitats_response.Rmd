---
title: "Generate the response variable for the VME models"
output: html_notebook
---

Currently thinking of two different approaches, one using the classified points as the main element, another one using the species data.
Different approach means different defition/set of rules for declaring VMEs!

# Approach 1.- Using the biotope classification

Requires: my.subs.small, trimmedwide, indsp, indval

## Input data and libraries
```{r}
library(dplyr)
library(rgdal)
library(indicspecies)
library(mvabund)

## pick a biotope and find (manually for now) the first classification level at which it splits

clname = "SubTmpMrgS6"
level = "level7"

hab_sub <- my.subs.small %>%
  filter(class==clname)%>%
  select(contains(level))%>%
  pull()

spe_sub <- trimmedwide %>%
  left_join(my.subs.small)%>%
  filter(class==clname)%>%
  #ungroup()%>%
  select(all_of(indsp))

spe_sub_nude <- spe_sub %>% ungroup() %>% select(-SampID)

## make a plot of species composition of subclasses

cl <- list(spe_sub_nude, as.factor(hab_sub))
names(cl)<-c("spe_sub", "hab_sub")
spe_subMV <- mvabund(cl$spe_sub)
plot(spe_subMV~hab_sub, data=cl)

```

